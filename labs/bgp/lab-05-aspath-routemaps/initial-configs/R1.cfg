!
! R1 Initial Configuration
! BGP Lab 05 - AS-Path Manipulation & Route-Maps
! (Chained from Lab 04 solutions — prefix-list filtering active)
!
hostname R1
!
interface Loopback0
 ip address 172.16.1.1 255.255.255.255
 no shutdown
!
interface Loopback1
 ip address 192.168.1.1 255.255.255.0
 no shutdown
!
interface Loopback2
 ip address 192.168.2.1 255.255.255.0
 no shutdown
!
interface Loopback3
 ip address 192.168.3.1 255.255.255.0
 no shutdown
!
interface FastEthernet0/0
 description Link to R4 (Enterprise Internal)
 ip address 10.1.14.1 255.255.255.252
 no shutdown
!
interface FastEthernet1/0
 description Link to R2 (ISP-A) — Primary
 ip address 10.1.12.1 255.255.255.252
 no shutdown
!
interface FastEthernet1/1
 description Link to R3 (ISP-B) — Backup
 ip address 10.1.13.1 255.255.255.252
 no shutdown
!
router ospf 1
 router-id 172.16.1.1
 network 10.1.14.0 0.0.0.3 area 0
 network 172.16.1.1 0.0.0.0 area 0
!
ip prefix-list FROM-ISP-A seq 10 permit 198.51.100.0/24
ip prefix-list FROM-ISP-A seq 20 deny 0.0.0.0/0 le 32
!
ip prefix-list FROM-ISP-B seq 10 deny 203.0.115.0/24
ip prefix-list FROM-ISP-B seq 20 permit 0.0.0.0/0 le 32
!
ip prefix-list TO-ISP-B seq 10 permit 192.168.1.0/24
ip prefix-list TO-ISP-B seq 20 deny 0.0.0.0/0 le 32
!
router bgp 65001
 bgp router-id 172.16.1.1
 neighbor 10.1.12.2 remote-as 65002
 neighbor 10.1.12.2 weight 100
 neighbor 10.1.12.2 soft-reconfiguration inbound
 neighbor 10.1.12.2 prefix-list FROM-ISP-A in
 neighbor 10.1.13.2 remote-as 65003
 neighbor 10.1.13.2 soft-reconfiguration inbound
 neighbor 10.1.13.2 prefix-list FROM-ISP-B in
 neighbor 10.1.13.2 prefix-list TO-ISP-B out
 neighbor 172.16.4.4 remote-as 65001
 neighbor 172.16.4.4 update-source Loopback0
 neighbor 172.16.4.4 next-hop-self
 !
 network 172.16.1.1 mask 255.255.255.255
 network 192.168.1.0 mask 255.255.255.0
 network 192.168.2.0 mask 255.255.255.0
 network 192.168.3.0 mask 255.255.255.0
!
line con 0
 logging synchronous
 exec-timeout 0 0
!
end
